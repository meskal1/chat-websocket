"use strict";(self.webpackChunksimple_chat=self.webpackChunksimple_chat||[]).push([[986],{39986:function(e,n,a){function t(){return Promise.resolve()}function r(e){e=e.children;var n=(0,S.useState)("Chat"),a=(n=(0,N.Z)(n,2))[0],t=n[1],r=(0,S.useCallback)((function(e){t(e)}),[t]);n=(0,S.useCallback)((function(){r("Chat")}),[r]);return(0,F.jsx)(q.Provider,{value:{activeWorkspace:a,closeAdminPanel:n,displayWorkspace:r},children:e})}function s(e){var n=e.children,a=e.defaultValues,t=e.workspace,r=e.onSubmit,s=(e=(0,K.mx)()).client,l=e.channel,i=(e=e.setActiveChannel,(0,S.useState)(a.name)),c=(i=(0,N.Z)(i,2))[0],u=i[1],o=(i=(0,S.useState)(a.members),(i=(0,N.Z)(i,2))[0]),d=i[1],m=(i=(0,S.useState)({name:null,members:null}),(i=(0,N.Z)(i,2))[0]),h=i[1],p=null==(i=(i=t).match(/.*__(team|messaging)/))?void 0:i[1],v=(i=t).match("Channel-Create")?"create":i.match("Channel-Edit")?"update":void 0,f=(0,S.useCallback)(function(){var e=(0,Z.Z)((0,y.Z)().mark((function e(n){var a,t,r;return(0,y.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.name,t=n.members,p&&0!==t.length){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,s.channel(p,a,{name:a,members:t,demo:"team"});case 5:return r=e.sent,e.next=8,r.watch();case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[p,e,s]),x=(0,S.useCallback)(function(){var e=(0,Z.Z)((0,y.Z)().mark((function e(n){var a,t,r;return(0,y.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.name,r=n.members,t!==((null==l||null==(a=l.data)?void 0:a.name)||(null==l||null==(a=l.data)?void 0:a.id)))return e.next=4,null==l?void 0:l.update({name:t},{text:"Channel name changed to ".concat(t)});e.next=4;break;case 4:if(null!=r&&r.length)return e.next=7,null==l?void 0:l.addMembers(r);e.next=7;break;case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[l]),g=(0,S.useCallback)((function(e){var n=e.action,t=e.createChannelType,r=(e=e.values,{name:null,members:null});return"create"===n&&(r={name:e.name||"team"!==t?null:"Channel name is required",members:e.members.length<2?"At least one additional member is required":null}),"update"===n&&e.name===a.name&&0===e.members.length&&(r={name:"Name not changed (change name or add members)",members:"No new members added (change name or add members)"}),Object.values(r).some((function(e){return!!e}))?r:null}),[a.name]);t=(0,S.useCallback)(function(){var e=(0,Z.Z)((0,y.Z)().mark((function e(n){var a;return(0,y.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),a=g({values:{name:c,members:o},action:v,createChannelType:p}))return h(a),e.abrupt("return");e.next=5;break;case 5:if(e.prev=5,"create"===v)return e.next=9,f({name:c,members:o});e.next=9;break;case 9:if("update"===v)return e.next=12,x({name:c,members:o});e.next=12;break;case 12:r(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),console.error(e.t0);case 18:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(n){return e.apply(this,arguments)}}(),[v,p,c,o,f,x,r,g]),i=(0,S.useCallback)((function(e){e.preventDefault(),u(e.target.value)}),[]),e=(0,S.useCallback)((function(e){d((function(n){var a=e.target.value;return e.target.checked?n.length?[].concat((0,X.Z)(n),[a]):[a]:null==n?void 0:n.filter((function(e){return e!==a}))}))}),[]);return(0,S.useEffect)((function(){u(a.name),d(a.members)}),[a,p]),(0,F.jsx)(ee.Provider,{value:{createChannelType:p,errors:m,name:c,members:o,handleInputChange:i,handleMemberSelect:e,handleSubmit:t},children:n})}function l(){return(0,S.useContext)(ee)}function i(e){var n=e.buttonText;e=e.onButtonClick;return(0,F.jsx)("div",{className:"admin-panel__form-footer",children:(0,F.jsx)("button",{onClick:e,children:n})})}function c(e){return e=e.onClose,(0,F.jsx)("button",{className:ne,onClick:e})}function u(e){var n=e.onClose;e=e.title;return(0,F.jsxs)("div",{className:"admin-panel__form-header",children:[(0,F.jsx)("div",{className:"workspace-header__title workspace-header__block",children:e}),(0,F.jsx)(c,{onClose:n})]})}function o(e){return e=e.errorMessage,(0,F.jsx)("div",{className:"admin-panel__form-validation-error",children:void 0===e?"":e})}function d(e){var n=e.name,a=e.error,t=e.placeholder;e=e.onChange;return(0,F.jsxs)("div",{className:"channel-name-input-field",children:[(0,F.jsxs)("h2",{children:[(0,F.jsx)("span",{children:"Name"}),(0,F.jsx)(o,{errorMessage:a})]}),(0,F.jsx)("input",{onChange:e,placeholder:void 0===t?"channel-name":t,type:"text",value:void 0===n?"":n})]})}function m(e){e=e.children;var n=(a=l()).errors,a=a.createChannelType;return(0,F.jsxs)("div",{className:"user-list__container",children:[(!a||"team"===a)&&(0,F.jsxs)("h2",{children:[(0,F.jsx)("span",{children:"Add Members"}),(0,F.jsx)(o,{errorMessage:n.members})]}),(0,F.jsxs)("div",{className:"user-list__header user-list__row",children:[(0,F.jsxs)("div",{className:"user-list__column-block",children:[(0,F.jsx)("p",{children:"User"}),(0,F.jsx)("p",{className:"user-list__column--last-active",children:"Last Active"})]}),(0,F.jsx)("div",{className:"user-list__column--checkbox",children:(0,F.jsx)("p",{children:"Invite"})})]}),e]})}function h(e){var n=e.index,a=(e=e.user,l().handleMemberSelect),t=e.name||e.id;return(0,F.jsxs)("label",{htmlFor:e.id,title:t,className:"user-list__row",children:[(0,F.jsxs)("div",{className:"user-list__column-block",children:[(0,F.jsxs)("div",{className:"user-list__column--user-data",children:[(0,F.jsx)(ae.q,{image:e.image,name:t,size:32}),(0,F.jsx)("p",{className:"user-item__name",children:t})]}),(0,F.jsx)("p",{className:"user-list__column--last-active",children:te[n]||"Yesterday"})]}),(0,F.jsx)("div",{className:"user-list__column--checkbox",children:(0,F.jsx)("input",{type:"checkbox",name:"members",id:e.id,value:e.id,onChange:a})})]})}function p(){var e=(n=(0,K.mx)()).client,n=(n.channel,l().createChannelType),a=(0,S.useState)(null),t=(a=(0,N.Z)(a,2))[0],r=a[1],s=(a=(0,S.useState)(),(a=(0,N.Z)(a,2))[0]),i=a[1],c=[e.userID,"deleted-user-1234237-693e2db320a58b30cadd552e894c0ea8","deleted-user-1237314-fdb61ef2f40d7e9ec6d44c5da18d98a6","freelancer-self-employed"];return(0,S.useEffect)((function(){var n=function(){var n=(0,Z.Z)((0,y.Z)().mark((function n(){var a;return(0,y.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t)return n.abrupt("return");n.next=2;break;case 2:return r("loading"),n.prev=3,n.next=6,e.queryUsers({id:{$nin:c}},{id:1},{limit:30});case 6:(a=n.sent).users.length?i(a.users):r("empty"),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(3),r("error");case 13:r(null);case 14:case"end":return n.stop()}}),n,null,[[3,10]])})));return function(){return n.apply(this,arguments)}}();e&&n()}),[e,n]),(0,F.jsx)(m,{children:t?(0,F.jsx)("div",{className:"user-list__message",children:re[t]}):(null==s?void 0:s.length)&&s.map((function(e,n){return(0,F.jsx)(h,{index:n,user:e},e.id)}))})}function v(){var e=U().closeAdminPanel,n=(s=l()).createChannelType,a=s.name,t=s.handleInputChange,r=s.handleSubmit,s=s.errors;return(0,F.jsxs)("div",{className:"admin-panel__form",children:[(0,F.jsx)(u,{onClose:e,title:"team"===n?"Create new channel":"Send direct message"}),"team"===n&&(0,F.jsx)(d,{error:s.name,name:a,onChange:t,placeholder:"channel-name (no spaces)"}),(0,F.jsx)(p,{}),(0,F.jsx)(i,{onButtonClick:r,buttonText:"team"===n?"Create channel":"Create message group"})]})}function f(){var e=U().closeAdminPanel,n=(r=l()).name,a=r.handleInputChange,t=r.handleSubmit,r=r.errors;return(0,F.jsxs)("div",{className:"admin-panel__form",children:[(0,F.jsx)(u,{onClose:e,title:"Edit channel"}),(0,F.jsx)(d,{name:n,error:r.name,onChange:a}),(0,F.jsx)(p,{}),(0,F.jsx)(i,{buttonText:"Save changes",onButtonClick:t})]})}function x(){var e,n=U().displayWorkspace,a=(0,K.mx)().client,t=(r=(0,me.JN)()).channel,r=r.watcher_count,s="".concat((null==t||null==(s=t.data)?void 0:s.name)||(null==t||null==(s=t.data)?void 0:s.id)||"random"),l=(0,S.useCallback)((function(){n("Admin-Channel-Edit")}),[n]);return(0,F.jsxs)("div",{className:"team-channel-header__container",children:[(0,F.jsx)("div",{className:"typing-indicator",children:(0,F.jsx)(he.c,{})}),"messaging"===t.type?(t=Object.values(t.state.members).filter((function(e){return(null==(e=e.user)?void 0:e.id)!==a.userID})),e=t.length-3,(0,F.jsx)(F.Fragment,{children:t.length?(0,F.jsxs)("div",{className:"workspace-header__block",children:[t.map((function(e,n){return e=e.user,2<n?null:(0,F.jsxs)("div",{className:"workspace-header__block-item",children:[(0,F.jsx)(ae.q,{image:null==e?void 0:e.image,name:(null==e?void 0:e.name)||(null==e?void 0:e.id),size:50}),(0,F.jsx)("p",{className:"team-channel-header__name user",children:(null==e?void 0:e.name)||(null==e?void 0:e.id)||"Johnny Blaze"})]},n)})),0<e&&(0,F.jsx)("p",{className:"team-channel-header__name user",children:"and ".concat(e," more")})]}):(0,F.jsxs)("div",{className:"workspace-header__block",children:[(0,F.jsx)(ae.q,{image:null,size:50}),(0,F.jsx)("p",{className:"team-channel-header__name user",children:"Johnny Blaze"})]})})):(0,F.jsxs)("div",{className:"workspace-header__block",children:[(0,F.jsx)("div",{className:"team-channel-header__name workspace-header__title",children:s}),(0,F.jsx)("button",{className:"workspace-info-button",onClick:l})]}),(0,F.jsx)("div",{className:"workspace-header__block",children:(0,F.jsx)("div",{className:"workspace-header__subtitle",children:(t=r)?"".concat(t," online"):"No users online"})})]})}function g(){var e=U().activeWorkspace,n=new Date;return(0,F.jsx)(F.Fragment,{children:e.match("Admin")?(0,F.jsx)(se,{}):(0,F.jsx)("div",{className:"channel__container",children:(0,F.jsx)(R.$,{EmptyStateIndicator:function(){return(0,F.jsx)("div",{className:"channel-empty__container",children:(0,F.jsx)("p",{className:"channel-empty__secondary-description",children:"Send messages, attachments, links, emojis, and more."})})},LoadingIndicator:function(){return null},ReactionsList:$.Y,DateSeparator:function(){return(0,F.jsx)(H.Z,{formatDate:function(){return"".concat(n.getDate()+" "+ve[n.getMonth()])},date:new Date,position:"center"})},MessageTimestamp:function(){return(0,F.jsx)(V.i,{format:"H:mm"})},children:(0,F.jsx)(Y,{children:(0,F.jsx)(pe,{})})})})})}function j(e){e=e.channel;var n,a=(0,K.mx)().client,t="John Doe";return(e=Object.values(e.state.members).filter((function(e){return(null==(e=e.user)?void 0:e.id)!==a.userID}))).length&&1!==e.length?(0,F.jsxs)("div",{className:"channel-preview__item multi",children:[(0,F.jsx)("span",{children:(0,F.jsx)(ae.q,{image:null==(n=e[0].user)?void 0:n.image,name:(null==(n=e[0].user)?void 0:n.name)||(null==(n=e[0].user)?void 0:n.id),size:18})}),(0,F.jsx)(ae.q,{image:null==(n=e[1].user)?void 0:n.image,name:(null==(n=e[1].user)?void 0:n.name)||(null==(n=e[1].user)?void 0:n.id),size:18}),(0,F.jsxs)("p",{children:[(null==(n=e[0].user)?void 0:n.name)||(null==(n=e[0].user)?void 0:n.id)||t,","," ",(null==(n=e[1].user)?void 0:n.name)||(null==(n=e[1].user)?void 0:n.id)||t]})]}):(n=e[0],(0,F.jsxs)("div",{className:"channel-preview__item single",children:[(0,F.jsx)(ae.q,{image:null==(e=n.user)?void 0:e.image,name:(null==(e=n.user)?void 0:e.name)||(null==(e=n.user)?void 0:e.id),size:36}),(0,F.jsx)("p",{children:(null==n||null==(e=n.user)?void 0:e.name)||(null==n||null==(e=n.user)?void 0:e.id)||t})]}))}function b(e){var n=e.channel,a=(e=(0,K.mx)()).channel,t=e.setActiveChannel,r=(e=(0,S.useState)(n.countUnread()),(e=(0,N.Z)(e,2))[0]),s=e[1],l=U().displayWorkspace;e=(0,S.useCallback)((function(){l("Chat"),t&&t(n),s(0)}),[n,l,t]);return(0,S.useEffect)((function(){0<n.countUnread()&&(null==n?void 0:n.id)!==(null==a?void 0:a.id)&&s(n.countUnread())}),[n.countUnread()]),(0,F.jsxs)("button",{className:(0,_e.W)("channel-preview",{selected:(null==n?void 0:n.id)===(null==a?void 0:a.id)}),onClick:e,children:[(0,F.jsx)(j,{channel:n}),0<r&&(0,F.jsx)("div",{className:"total-unread-count",children:r})]})}function _(e){var n=e.focusedId,a=(e=e.result,(0,K.mx)()),t=a.client,r=a.setActiveChannel,s=e;return(0,F.jsxs)("div",{onClick:function(){De({client:t,setActiveChannel:r,user:s})},className:(0,_e.W)("channel-search__result-container",{highlighted:n===s.id}),children:[(0,F.jsx)(ae.q,{image:s.image,name:s.name||s.id,size:24}),(0,F.jsx)("p",{className:"channel-search__result-text",children:s.name||s.id||"Johnny Blaze"})]})}function C(e){var n=e.directChannels,a=e.focusedId,t=e.loading,r=e.setChannel,s=e.setQuery;return(0,S.useEffect)((function(){return document.addEventListener("click",(function(){return s("")})),function(){document.removeEventListener("click",(function(){return s("")}))}}),[]),(0,F.jsxs)("div",{className:"channel-search__results",children:[(0,F.jsx)("p",{className:"channel-search__results-header",children:"Users"}),t&&!(null!=n&&n.length)&&(0,F.jsx)("p",{className:"channel-search__results-header",children:(0,F.jsx)("i",{children:"Loading..."})}),t||null!=n&&n.length?null==n?void 0:n.map((function(e,n){return(0,F.jsx)(_,{result:e,focusedId:a,setChannel:r},n)})):(0,F.jsx)("p",{className:"channel-search__results-header",children:(0,F.jsx)("i",{children:"No direct messages found"})})]})}function k(){var e=(0,fe.s0)(),n=(0,ge.T)();return(0,F.jsxs)("div",{className:"sidebar",children:[(0,F.jsx)(Ee,{}),(0,F.jsx)(Se,{}),(0,F.jsx)("div",{className:"logout-button-container",children:(0,F.jsx)("button",{className:"logout-button",onClick:function(){(0,O.F)(),n((0,je.nf)(!1)),e(xe.m.LOGIN)},children:"Log out"})})]})}a.r(n),a.d(n,{ChatApp:function(){return Le}});var y=a(74165),Z=a(15861),N=a(29439),w=a(1413),S=a(72791),I=a(21626),A=(n=a(31054),a(15502)),M=a(27881),D=a(98190),E=a(16653),F=a(80184),q=(0,S.createContext)({activeWorkspace:"Chat",closeAdminPanel:t,displayWorkspace:t}),U=function(){return(0,S.useContext)(q)},L=function(e){return function(e){window.parent.postMessage(e,"*")}},P="https://youtu.be/Ujvy-DEA-UM",T="react-to-message",W="run-giphy",G="send-youtube",z="drag-drop-image",J="start-thread",B="send-message",O=a(28617),R=a(77540),$=a(54149),H=a(51888),V=a(37861),Q=(0,S.createContext)({}),Y=function(e){e=e.children;var n=(0,S.useState)({"main-input":!1,"thread-input":!1}),a=(n=(0,N.Z)(n,2))[0],t=n[1],r=(n=(0,S.useCallback)((function(e){t((function(n){return e?(0,w.Z)((0,w.Z)({},n),{},{"thread-input":!1}):(0,w.Z)((0,w.Z)({},n),{},{"main-input":!1})}))}),[]),(0,S.useCallback)((function(){t((function(e){return(0,w.Z)((0,w.Z)({},e),{},{"main-input":!1})}))}),[])),s=(0,S.useCallback)((function(){t((function(e){return(0,w.Z)((0,w.Z)({},e),{},{"thread-input":!1})}))}),[]),l=(0,S.useCallback)((function(e){return e?a["thread-input"]:a["main-input"]}),[a]),i=(0,S.useCallback)((function(){return a["main-input"]}),[a]),c=(0,S.useCallback)((function(){return a["thread-input"]}),[a]),u=(0,S.useCallback)((function(){t((function(e){return(0,w.Z)((0,w.Z)({},e),{},{"main-input":!0})}))}),[]),o=(0,S.useCallback)((function(){t((function(e){return(0,w.Z)((0,w.Z)({},e),{},{"thread-input":!0})}))}),[]);return(0,F.jsx)(Q.Provider,{value:{clearGiphyFlag:n,clearGiphyFlagMainInput:r,clearGiphyFlagThread:s,inputHasGiphyMessage:l,isComposingGiphyMessage:i,isComposingGiphyReply:c,setComposeGiphyMessageFlag:u,setComposeGiphyReplyFlag:o},children:e})},K=a(28802),X=a(93433),ee=(0,S.createContext)({handleInputChange:function(){return null},handleMemberSelect:function(){return null},handleSubmit:function(){return null},members:[],name:"",errors:{name:null,members:null}}),ne="CloseButton_closeButton__Tb+s+",ae=a(84565),te=["12 min ago","27 min ago","6 hours ago","14 hours ago"],re={empty:"No users found.",error:"Error loading, please refresh and try again.",loading:"Loading users..."},se=function(){var e=(n=(0,K.mx)()).client,n=n.channel,a=(t=U()).displayWorkspace,t=t.activeWorkspace,r=(0,S.useCallback)((function(){return a("Chat")}),[a]),l={name:"",members:[]},i=null;return t.match("Channel-Create")?(l={members:e.userID?[e.userID]:[],name:""},i=v):t.match("Channel-Edit")&&(l={members:[],name:(null==n||null==(e=n.data)?void 0:e.name)||(null==n||null==(e=n.data)?void 0:e.id)},i=f),(0,F.jsx)(s,{workspace:t,onSubmit:r,defaultValues:l,children:(0,F.jsx)("div",{className:"channel__container",children:i&&(0,F.jsx)(i,{})})})},le=a(3979),ie=a(80863),ce=a(5628),ue=a(26982),oe=a(9667),de=a(99729),me=a(73461),he=a(57703),pe=function(){var e=(t=(0,S.useContext)(Q)).inputHasGiphyMessage,n=t.clearGiphyFlag,a=(0,le.uz)().sendMessage,t=(0,w.Z)((0,w.Z)({},ie.Z1.team),{},{user:!0}),r=(0,w.Z)((0,w.Z)({},ie.Z1.messaging),{},{user:!0});t=(0,w.Z)((0,w.Z)({},ie.Z1),{},{team:t,messaging:r}),r=(0,S.useCallback)((function(t){var r={attachments:t.attachments,mentioned_users:t.mentioned_users,parent_id:null==(r=t.parent)?void 0:r.id,parent:t.parent,text:t.text},s=!!r.parent_id;e(s)&&(t="/giphy ".concat(t.text),r=(0,w.Z)((0,w.Z)({},r),{},{text:t})),a&&(t=a(r),(0,I.t1)(t,"send message"),n(s))}),[e,a,n]);return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsxs)(ce.R,{children:[(0,F.jsx)(x,{}),(0,F.jsx)(ue.r,{pinPermissions:t,hideDeletedMessages:!0,hideNewMessageSeparator:!0}),(0,F.jsx)(oe.R,{grow:!0,overrideSubmitHandler:r})]}),(0,F.jsx)(de.j,{additionalMessageInputProps:{grow:!0,overrideSubmitHandler:r}})]})},ve=["January","February","March","April","May","June","July","August","September","October","November","December"],fe=a(57689),xe=a(13294),ge=a(9911),je=a(50312),be=a(22649),_e=a(28182),Ce=a(44925),ke=["children","error","loading","type"],ye=(0,S.memo)((function(e){var n=e.children,a=void 0!==(a=e.error)&&a,t=e.loading,r=e.type,s=((0,Ce.Z)(e,ke),U().displayWorkspace);e=(0,S.useCallback)((function(){s("Admin-Admin-Channel-Create__".concat(r))}),[r,s]);return a?"team"===r?(0,F.jsx)("div",{className:"team-channel-list",children:(0,F.jsx)("p",{className:"team-channel-list__message",children:"Connection error, please wait a moment and try again."})}):null:t?(0,F.jsx)("div",{className:"team-channel-list",children:(0,F.jsxs)("p",{className:"team-channel-list__message loading",children:["team"===r?"Channels":"Messages"," loading...."]})}):(0,F.jsxs)("div",{className:"team-channel-list",children:[(0,F.jsxs)("div",{className:"team-channel-list__header",children:[(0,F.jsx)("p",{className:"team-channel-list__header__title",children:"team"===r?"Channels":"Direct Messages"}),(0,F.jsx)("button",{className:"team-channel-button",onClick:e})]}),n]})})),Ze=new D.Z,Ne={state:!0,watch:!0,presence:!0,limit:10,message_limit:300},we=[{last_message_at:-1},{updated_at:-1}],Se=function(){var e=[{type:"messaging",demo:"team",members:{$in:[Ze.get("userId")]}}];return(0,F.jsx)(be.G,{channelRenderFilterFn:function(e){return e.filter((function(e){return"messaging"===e.type}))},filters:e[0],options:Ne,sort:we,setActiveChannelOnMount:!1,List:function(e){return(0,F.jsx)(ye,(0,w.Z)((0,w.Z)({},e),{},{type:"messaging"}))},Preview:function(e){return(0,F.jsx)(b,(0,w.Z)((0,w.Z)({},e),{},{type:"messaging"}))}})},Ie=a(95095),Ae=a.n(Ie),Me=a(85030),De=function(){var e=(0,Z.Z)((0,y.Z)().mark((function e(n){var a,t,r,s,l;return(0,y.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.client,t=n.setActiveChannel,r=n.user,s={type:"messaging",member_count:2,members:{$eq:[r.id,a.userID||""]}},e.next=4,a.queryChannels(s);case 4:if(s=e.sent,l=(l=(0,N.Z)(s,1))[0])return e.abrupt("return",t(l));e.next=9;break;case 9:return l=a.channel("messaging",{members:[r.id,a.userID||""]}),e.abrupt("return",t(l));case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Ee=function(){var e=(a=(0,K.mx)()).client,n=a.setActiveChannel,a=(0,S.useState)(),t=(a=(0,N.Z)(a,2))[0],r=a[1],s=(a=(0,S.useState)(),(a=(0,N.Z)(a,2))[0]),l=a[1],i=(a=(0,S.useState)(),(a=(0,N.Z)(a,2))[0]),c=a[1],u=(a=(0,S.useState)(),(a=(0,N.Z)(a,2))[0]),o=a[1],d=(a=(0,S.useState)(""),(a=(0,N.Z)(a,2))[0]),m=a[1],h=(a=(0,S.useState)(!1),(a=(0,N.Z)(a,2))[0]),p=a[1],v=(a=(0,S.useState)(""),(a=(0,N.Z)(a,2))[0]),f=a[1],x=(0,S.useCallback)((function(a){"ArrowDown"===a.key?o((function(e){return void 0===e||void 0===t||e===t.length-1?0:e+1})):"ArrowUp"===a.key?o((function(e){return void 0===e||void 0===t?0:0===e?t.length-1:e-1})):"Enter"===a.key&&(a.preventDefault(),void 0!==t&&void 0!==u&&(a=t[u],(0,Me.J)(a)?n(a):De({client:e,setActiveChannel:n,user:a})),o(void 0),m(""),f(""))}),[t,e,u,n]),g=(a=function(){var n=(0,Z.Z)((0,y.Z)().mark((function n(a){var t,s,i,u;return(0,y.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,t=e.queryChannels({type:"team",name:{$autocomplete:a}},{},{limit:5}),s=e.queryUsers({id:{$ne:e.userID||""},$and:[{name:{$autocomplete:a}}]},{id:1},{limit:15}),n.next=5,Promise.all([t,s]);case 5:t=n.sent,s=(0,N.Z)(t,2),i=s[0],u=s[1].users,i.length&&l(i),u.length&&c(u),r([].concat((0,X.Z)(i),(0,X.Z)(u))),n.next=17;break;case 14:n.prev=14,n.t0=n.catch(0),f("");case 17:p(!1);case 18:case"end":return n.stop()}}),n,null,[[0,14]])})));return function(e){return n.apply(this,arguments)}}(),Ae()(a,200,{trailing:!0}));return(0,S.useEffect)((function(){return v&&document.addEventListener("keydown",x),function(){return document.removeEventListener("keydown",x)}}),[x,v]),(0,S.useEffect)((function(){v||(l([]),c([]))}),[v]),(0,S.useEffect)((function(){u&&0<=u&&t&&m(t[u].id||"")}),[t,u]),(0,F.jsxs)("div",{className:"channel-search__container",children:[(0,F.jsx)("div",{className:"channel-search__input__wrapper",children:(0,F.jsx)("input",{onChange:function(e){e.preventDefault(),p(!0),o(void 0),f(e.target.value),e.target.value&&g(e.target.value)},placeholder:"Search",type:"text",value:v})}),v&&(0,F.jsx)(C,{teamChannels:s,directChannels:i,focusedId:d,loading:h,setChannel:function(e){f(""),n(e)},setQuery:f})]})},Fe=new D.Z,qe=new n.V({language:"en",translationsForLanguage:(0,w.Z)({},A)}),Ue=I.c8.getInstance("k3v8eeq8jtv4",{enableInsights:!0,enableWSFallback:!0}),Le=function(){var e=(0,S.useState)(null),n=(e=(0,N.Z)(e,2))[0],a=e[1],t=Fe.get("token"),s={id:Fe.get("userId"),name:Fe.get("username"),image:Fe.get("avatarURL"),hashedPassword:Fe.get("hashedPassword")};return function(e){var n=e.chatClient,a=e.targetOrigin;(0,S.useEffect)((function(){function e(e){var n,a=e.message;switch(e.type){case"reaction.new":t(T);break;case"message.new":if("giphy"===(null==a?void 0:a.command))t(W);else{if(null!=a&&null!=(n=a.attachments)&&n.length){if("video"===a.attachments[0].type&&a.attachments[0].og_scrape_url===P){t(G);break}if("image"===a.attachments[0].type){t(z);break}}null!=a&&a.parent_id?t(J):t(B)}}}var t=L(a);return n&&n.on(e),function(){return null==n?void 0:n.off(e)}}),[n,a])}({chatClient:Ue,targetOrigin:"https://server-six-pearl.vercel.app/auth/"}),(0,S.useEffect)((function(){return t&&function(){var e=(0,Z.Z)((0,y.Z)().mark((function e(){return(0,y.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ue.connectUser(s,t);case 3:a(Ue),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),new RegExp("was deleted").test(e.t0.message)&&((0,O.F)(),Ue.disconnectUser());case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}()(),function(){Ue.disconnectUser()}}),[]),n?(0,F.jsx)("div",{className:"app-content",children:(0,F.jsx)(M.e,{client:Ue,i18nInstance:qe,children:(0,F.jsxs)(r,{children:[(0,F.jsx)(k,{}),(0,F.jsx)(g,{})]})})}):(0,F.jsx)(E.A,{})}}}]);